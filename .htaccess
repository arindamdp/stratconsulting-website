
RewriteEngine on

# Security Headers (GoDaddy Compatible)
<IfModule mod_headers.c>
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"
Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Enable Compression
<IfModule mod_deflate.c>
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# Browser Caching
<IfModule mod_expires.c>
ExpiresActive on
ExpiresByType text/css "access plus 1 year"
ExpiresByType application/javascript "access plus 1 year"
ExpiresByType image/png "access plus 1 year"
ExpiresByType image/jpg "access plus 1 year"
ExpiresByType image/jpeg "access plus 1 year"
</IfModule>

# Force HTTPS (uncomment after SSL is setup)
# RewriteEngine On
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Prevent access to sensitive files
<Files ".htaccess">
Order allow,deny
Deny from all
</Files>
RewriteCond %{HTTPS} off
RewriteCond %{HTTP:X-Forwarded-SSL} !on
RewriteCond %{HTTP_HOST} ^stratconsulting\.co\.uk$ [OR]
RewriteCond %{HTTP_HOST} ^www\.stratconsulting\.co\.uk$
RewriteRule ^/?$ "https\:\/\/www\.stratconsulting\.co\.uk\/" [R=301,L]

RewriteCond %{HTTP_REFERER} !^http://stratconsulting.co.uk/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^http://stratconsulting.co.uk$      [NC]
RewriteCond %{HTTP_REFERER} !^http://www.stratconsulting.co.uk/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^http://www.stratconsulting.co.uk$      [NC]
RewriteCond %{HTTP_REFERER} !^https://stratconsulting.co.uk/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^https://stratconsulting.co.uk$      [NC]
RewriteCond %{HTTP_REFERER} !^https://www.stratconsulting.co.uk/.*$      [NC]
RewriteCond %{HTTP_REFERER} !^https://www.stratconsulting.co.uk$      [NC]
RewriteRule .*\.(jpg|jpeg|gif|png|bmp)$ - [F,NC]


<Files 403.shtml>
order allow,deny
allow from all
</Files>

deny from 212.102.57.208
deny from 212.102.57.68
deny from 212.102.57.2
deny from 199.167.138.22

deny from 190.2.132.136
deny from 178.159.37.4
deny from 178.159.37.17
deny from 185.190.42.200
deny from 212.102.57.215
deny from 212.102.57.85
deny from 156.146.62.131
deny from 165.231.182.43
deny from 191.101.157.166
deny from 212.102.57.67
deny from 212.102.57.3
deny from 212.102.36.183
deny from 194.32.122.37
deny from 196.196.53.9
deny from 165.231.182.126
deny from 89.249.73.212
deny from 165.231.182.128
deny from 45.89.70.31
deny from 45.89.70.30
deny from 45.117.164.28
deny from 86.106.74.253
